# ğŸ” Supabase Connection Parameters

## Connection Details

```bash
user=postgres.gcuelkevdajcuiysyqgq
password=[YOUR-PASSWORD]  # Supabase'den alÄ±n
host=aws-1-eu-central-1.pooler.supabase.com
port=6543  # âš ï¸ Session mode (NOT 5432!)
dbname=postgres
```

## âš ï¸ IMPORTANT: Session Mode vs Transaction Mode

| Mode | Port | Django Compatible? |
|------|------|-------------------|
| **Session** | 6543 | âœ… YES |
| Transaction | 5432 | âŒ NO |

**Mutlaka port 6543 kullanÄ±n!**

---

## ğŸ”§ Local Test

### 1. Install Dependencies
```bash
pip install psycopg2-binary python-dotenv
```

### 2. Test Connection
```bash
./test_supabase_connection.sh
```

Bu script ÅŸunlarÄ± test eder:
- âœ… Raw psycopg2 connection
- âœ… Django database connection
- âœ… Migrations status
- âœ… Users in database

---

## ğŸš€ Render.com Setup

### Full Connection String

Supabase password'Ã¼nÃ¼zÃ¼ `[YOUR-PASSWORD]` yerine yazÄ±n:

```
postgresql://postgres.gcuelkevdajcuiysyqgq:[YOUR-PASSWORD]@aws-1-eu-central-1.pooler.supabase.com:6543/postgres
```

### Render Environment Variable

```
Key: DATABASE_URL
Value: postgresql://postgres.gcuelkevdajcuiysyqgq:[YOUR-PASSWORD]@aws-1-eu-central-1.pooler.supabase.com:6543/postgres
```

---

## ğŸ“‹ Complete Render Environment Variables

Copy-paste these to Render Dashboard â†’ Environment:

### 1. DATABASE_URL
```
postgresql://postgres.gcuelkevdajcuiysyqgq:[YOUR-PASSWORD]@aws-1-eu-central-1.pooler.supabase.com:6543/postgres
```
**Replace `[YOUR-PASSWORD]` with your actual Supabase password!**

### 2. SECRET_KEY
```
[Auto-generated by Render or generate your own]
```

### 3. DEBUG
```
False
```

### 4. ALLOWED_HOSTS
```
.onrender.com,localhost
```

### 5. CORS_ALLOWED_ORIGINS
```
https://frontend-dua-miss.vercel.app,https://frontend-duamiss.onrender.com
```

### 6. CSRF_TRUSTED_ORIGINS
```
https://backend-duamiss.onrender.com,https://*.onrender.com,https://*.vercel.app
```

---

## ğŸ” Where to Find Supabase Password?

1. Go to [Supabase Dashboard](https://supabase.com/dashboard)
2. Select your project
3. Settings â†’ Database
4. Connection pooling â†’ Session mode
5. Look for the connection string - password is there

**OR** if you can't see it:
1. Settings â†’ Database â†’ Reset Database Password
2. Copy the new password
3. Update everywhere (local .env and Render)

---

## ğŸ§ª Test Commands

### Local Test
```bash
# Export password first
export DB_PASSWORD="your-actual-password"

# Run test
./test_supabase_connection.sh
```

### Render Shell Test
```bash
# In Render Shell:
python manage.py check --database default
python manage.py showmigrations
python manage.py migrate
```

### Create User (if needed)
```bash
python manage.py createsuperuser --username test --email test@test.com
# Enter password: tester.1
```

---

## âœ… Verification Checklist

- [ ] Password copied from Supabase
- [ ] Port is 6543 (NOT 5432)
- [ ] Connection string format is correct
- [ ] No spaces in connection string
- [ ] SSL mode is enabled (Django handles this)
- [ ] Local test passed
- [ ] Render environment updated
- [ ] Deploy successful
- [ ] Production test passed

---

## ğŸ› Troubleshooting

### Error: "connection refused"
- âœ… Check port is 6543 (not 5432)
- âœ… Verify password is correct
- âœ… Check Supabase project is active

### Error: "password authentication failed"
- âœ… Reset password in Supabase
- âœ… Update .env and Render
- âœ… No extra spaces in password

### Error: "SSL required"
- âœ… Already handled in settings.py
- âœ… Make sure using pooler endpoint

---

**Ready to deploy! ğŸš€**

After updating Render DATABASE_URL with your actual password, redeploy and test.
